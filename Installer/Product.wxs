<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">
	<Product Id="CEB08A5C-9292-4B51-896E-71EE75531C9A" Name="MapServer MapManager v1.1" Language="1033" Version="1.1.0.0" Manufacturer="Digital Mapping Solutions" UpgradeCode="B17B8E38-2C70-4032-8F95-4BA75FDFFB5E">
		<Package InstallerVersion="300" Compressed="yes" Description="MapServer MapManager Installer" InstallScope="perMachine"/>

        <Media Id="1" Cabinet="MapManager.cab" EmbedCab="yes" />

        <PropertyRef Id="NETFRAMEWORK40FULL"/>
        <Condition Message="This application requires .NET Framework 4.0. Please install the .NET Framework then run this installer again.">
            <![CDATA[Installed OR NETFRAMEWORK40FULL]]>
        </Condition>

        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="DesktopFolder" Name="Desktop"/>
			<Directory Id="ProgramFilesFolder" Name="PFiles">
				<Directory Id="INSTALLDIR" Name="MapManager">
                    <Directory Id="projlibDir" Name="projlib">
                        <Component Id="epsg" Guid="*">
                            <File Id="epsg" Name="epsg" Source="$(var.SolutionDir)..\release-1900\bin\proj\SHARE\epsg" />
                        </Component>
                        <Component Id="world" Guid="*">
                            <File Id="world" Name="world" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\world" Vital="yes"/>
                        </Component>
                        <Component Id="WO" Guid="*">
                            <File Id="WO" Name="WO" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\WO" Vital="yes"/>
                        </Component>
                        <Component Id="WI" Guid="*">
                            <File Id="WI" Name="WI" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\WI" Vital="yes"/>
                        </Component>
                        <Component Id="TN" Guid="*">
                            <File Id="TN" Name="TN" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\TN" Vital="yes"/>
                        </Component>
                        <Component Id="stpaul" Guid="*">
                            <File Id="stpaul" Name="stpaul" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\stpaul" Vital="yes"/>
                        </Component>
                        <Component Id="stlrnc" Guid="*">
                            <File Id="stlrnc" Name="stlrnc" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\stlrnc" Vital="yes"/>
                        </Component>
                        <Component Id="stgeorge" Guid="*">
                            <File Id="stgeorge" Name="stgeorge" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\stgeorge" Vital="yes"/>
                        </Component>
                        <Component Id="prvi" Guid="*">
                            <File Id="prvi" Name="prvi" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\prvi" Vital="yes"/>
                        </Component>
                        <Component Id="proj.db" Guid="*">
                            <File Id="proj.db" Name="proj.db" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\proj.db" Vital="yes"/>
                        </Component>
                        <Component Id="proj_def.dat" Guid="*">
                            <File Id="proj_def.dat" Name="proj_def.dat" Source="$(var.SolutionDir)..\release-1900\bin\proj\SHARE\proj_def.dat" Vital="yes"/>
                        </Component>
                        <Component Id="other.extra" Guid="*">
                            <File Id="other.extra" Name="other.extra" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\other.extra" Vital="yes"/>
                        </Component>
                        <Component Id="nzgd2kgrid0005.gsb" Guid="*">
                            <File Id="nzgd2kgrid0005.gsb" Name="nzgd2kgrid0005.gsb" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\nzgd2kgrid0005.gsb" Vital="yes"/>
                        </Component>
                        <Component Id="null" Guid="*">
                            <File Id="null" Name="null" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\null" Vital="yes"/>
                        </Component>
                        <Component Id="ntv1_can.dat" Guid="*">
                            <File Id="ntv1_can.dat" Name="ntv1_can.dat" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\ntv1_can.dat" Vital="yes"/>
                        </Component>
                        <Component Id="ntf_r93.gsb" Guid="*">
                            <File Id="ntf_r93.gsb" Name="ntf_r93.gsb" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\ntf_r93.gsb" Vital="yes"/>
                        </Component>
                        <Component Id="nad83" Guid="*">
                            <File Id="nad83" Name="nad83" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\nad83" Vital="yes"/>
                        </Component>
                        <Component Id="nad27" Guid="*">
                            <File Id="nad27" Name="nad27" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\nad27" Vital="yes"/>
                        </Component>
                        <Component Id="nad.lst" Guid="*">
                            <File Id="nad.lst" Name="nad.lst" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\nad.lst" Vital="yes"/>
                        </Component>
                        <Component Id="MD" Guid="*">
                            <File Id="MD" Name="MD" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\MD" Vital="yes"/>
                        </Component>
                        <Component Id="IGNF" Guid="*">
                            <File Id="IGNF" Name="IGNF" Source="$(var.SolutionDir)..\release-1900\bin\proj\SHARE\IGNF" Vital="yes"/>
                        </Component>
                        <Component Id="ITRF2014" Guid="*">
                            <File Id="ITRF2014" Name="ITRF2014" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\ITRF2014" Vital="yes"/>
                        </Component>
                        <Component Id="ITRF2008" Guid="*">
                            <File Id="ITRF2008" Name="ITRF2008" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\ITRF2008" Vital="yes"/>
                        </Component>
                        <Component Id="ITRF2000" Guid="*">
                            <File Id="ITRF2000" Name="ITRF2000" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\ITRF2000" Vital="yes"/>
                        </Component>
                        <Component Id="hawaii" Guid="*">
                            <File Id="hawaii" Name="hawaii" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\hawaii" Vital="yes"/>
                        </Component>
                        <Component Id="GL27" Guid="*">
                            <File Id="GL27" Name="GL27" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\GL27" Vital="yes"/>
                        </Component>
                        <Component Id="esri.extra" Guid="*">
                            <File Id="esri.extra" Name="esri.extra" Source="$(var.SolutionDir)..\release-1900\bin\proj\SHARE\esri.extra" Vital="yes"/>
                        </Component>
                        <Component Id="esri" Guid="*">
                            <File Id="esri" Name="esri" Source="$(var.SolutionDir)..\release-1900\bin\proj\SHARE\esri" Vital="yes"/>
                        </Component>
                        <Component Id="egm96_15.gtx" Guid="*">
                            <File Id="egm96_15.gtx" Name="egm96_15.gtx" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\egm96_15.gtx" Vital="yes"/>
                        </Component>
                        <Component Id="conus" Guid="*">
                            <File Id="conus" Name="conus" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\conus" Vital="yes"/>
                        </Component>
                        <Component Id="CH" Guid="*">
                            <File Id="CH" Name="CH" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\CH" Vital="yes"/>
                        </Component>
                        <Component Id="BETA2007.gsb" Guid="*">
                            <File Id="BETA2007.gsb" Name="BETA2007.gsb" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\BETA2007.gsb" Vital="yes"/>
                        </Component>
                        <Component Id="alaska" Guid="*">
                            <File Id="alaska" Name="alaska" Source="$(var.SolutionDir)..\release-1900\bin\proj6\SHARE\alaska" Vital="yes"/>
                        </Component>
                    </Directory>
                    <Directory Id="templatesDir" Name="templates">
                        <Component Id="new.map" Guid="*">
                            <File Id="new.map" Name="new.map" Source="$(var.MapManager.TargetDir)\templates\new.map" />
                        </Component>
                        <Component Id="mmstyles.map" Guid="*">
                            <File Id="mmstyles.map" Name="mmstyles.map" Source="$(var.MapManager.TargetDir)\templates\mmstyles.map" />
                        </Component>
                      <Component Id="annotation.map" Guid="*">
                        <File Id="annotation.map" Name="annotation.map" Source="$(var.MapManager.TargetDir)\templates\annotation.map" />
                      </Component>
                        <Component Id="symbols.sym" Guid="*">
                            <File Id="symbols.sym" Name="symbols.sym" Source="$(var.MapManager.TargetDir)\templates\symbols.sym" />
                        </Component>
                        <Component Id="font.list" Guid="*">
                            <File Id="font.list" Name="font.list" Source="$(var.MapManager.TargetDir)\templates\font.list" />
                        </Component>
                        <Component Id="flaeche1.png" Guid="*">
                            <File Id="flaeche1.png" Name="flaeche1.png" Source="$(var.MapManager.TargetDir)\templates\flaeche1.png" />
                        </Component>
                        <Component Id="flaeche1_1.png" Guid="*">
                            <File Id="flaeche1_1.png" Name="flaeche1_1.png" Source="$(var.MapManager.TargetDir)\templates\flaeche1_1.png" />
                        </Component>
                        <Component Id="flaeche2.png" Guid="*">
                            <File Id="flaeche2.png" Name="flaeche2.png" Source="$(var.MapManager.TargetDir)\templates\flaeche2.png" />
                        </Component>
                        <Component Id="flaeche2_1.png" Guid="*">
                            <File Id="flaeche2_1.png" Name="flaeche2_1.png" Source="$(var.MapManager.TargetDir)\templates\flaeche2_1.png" />
                        </Component>
                        <Component Id="flaeche3.png" Guid="*">
                            <File Id="flaeche3.png" Name="flaeche3.png" Source="$(var.MapManager.TargetDir)\templates\flaeche3.png" />
                        </Component>
                        <Component Id="schraffur.png" Guid="*">
                            <File Id="schraffur.png" Name="schraffur.png" Source="$(var.MapManager.TargetDir)\templates\schraffur.png" />
                        </Component>
                        <Component Id="stern.png" Guid="*">
                            <File Id="stern.png" Name="stern.png" Source="$(var.MapManager.TargetDir)\templates\stern.png" />
                        </Component>
                        <Component Id="welle.png" Guid="*">
                            <File Id="welle.png" Name="welle.png" Source="$(var.MapManager.TargetDir)\templates\welle.png" />
                        </Component>
                    </Directory>
                    <Directory Id="licenseDir" Name="license">
                        <Component Id="MapManagerLicense.rtf" Guid="*">
                            <File Id="MapManagerLicense.rtf" Name="MapManagerLicense.rtf" Source="$(var.SolutionDir)MapManagerLicense.rtf" />
                        </Component>
                        <Component Id="GDALLicense.rtf" Guid="*">
                            <File Id="GDALLicense.rtf" Name="GDALLicense.rtf" Source="$(var.SolutionDir)..\GDALLicense.rtf" />
                        </Component>
                        <Component Id="SZIPLicense.rtf" Guid="*">
                            <File Id="SZIPLicense.rtf" Name="SZIPLicense.rtf" Source="$(var.SolutionDir)..\SZIPLicense.rtf" />
                        </Component>
                        <Component Id="HDF4License.rtf" Guid="*">
                            <File Id="HDF4License.rtf" Name="HDF4License.rtf" Source="$(var.SolutionDir)..\HDF4License.rtf" />
                        </Component>
                        <Component Id="HDF5License.rtf" Guid="*">
                            <File Id="HDF5License.rtf" Name="HDF5License.rtf" Source="$(var.SolutionDir)..\HDF5License.rtf" />
                        </Component>
                        <Component Id="NetCDFLicense.rtf" Guid="*">
                            <File Id="NetCDFLicense.rtf" Name="NetCDFLicense.rtf" Source="$(var.SolutionDir)..\NetCDFLicense.rtf" />
                        </Component>
                        <Component Id="FITSLicense.rtf" Guid="*">
                            <File Id="FITSLicense.rtf" Name="FITSLicense.rtf" Source="$(var.SolutionDir)..\FITSLicense.rtf" />
                        </Component>                  
                    </Directory>
                    <Directory Id="gdalpluginsDir" Name="gdalplugins">
                        <Component Id="gdal_FITS.dll" Guid="*">
                            <File Id="gdal_FITS.dll" Name="gdal_FITS.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\plugins\gdal_FITS.dll" />
                        </Component>
                        <Component Id="gdal_GMT.dll" Guid="*">
                            <File Id="gdal_GMT.dll" Name="gdal_GMT.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\plugins\gdal_GMT.dll" />
                        </Component>
                        <Component Id="gdal_HDF4.dll" Guid="*">
                            <File Id="gdal_HDF4.dll" Name="gdal_HDF4.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\plugins\gdal_HDF4.dll" />
                        </Component>
                        <Component Id="gdal_HDF4Image.dll" Guid="*">
                            <File Id="gdal_HDF4Image.dll" Name="gdal_HDF4Image.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\plugins\gdal_HDF4Image.dll" />
                        </Component>
                        <Component Id="gdal_HDF5.dll" Guid="*">
                            <File Id="gdal_HDF5.dll" Name="gdal_HDF5.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\plugins\gdal_HDF5.dll" />
                        </Component>
                        <Component Id="gdal_HDF5Image.dll" Guid="*">
                            <File Id="gdal_HDF5Image.dll" Name="gdal_HDF5Image.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\plugins\gdal_HDF5Image.dll" />
                        </Component>
                        <Component Id="gdal_BAG.dll" Guid="*">
                            <File Id="gdal_BAG.dll" Name="gdal_BAG.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\plugins\gdal_BAG.dll" />
                        </Component>
                        <Component Id="gdal_netCDF.dll" Guid="*">
                            <File Id="gdal_netCDF.dll" Name="gdal_netCDF.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\plugins\gdal_netCDF.dll" />
                        </Component>
                    </Directory>
                    <Directory Id="pythonDir" Name="python">
                        <Component Id="mapscript.py" Guid="*">
                            <File Id="mapscript.py" Name="mapscript.py" Source="$(var.SolutionDir)..\release-1900\bin\ms\python\mapscript.py" />
                        </Component>
                        <Component Id="_mapscript.pyd" Guid="*">
                            <File Id="_mapscript.pyd" Name="_mapscript.pyd" Source="$(var.SolutionDir)..\release-1900\bin\ms\python\_mapscript.pyd" />
                        </Component>
                        <Directory Id="osgeoDir" Name="osgeo">
                            <Component Id="__init__.py" Guid="*">
                                <File Id="__init__.py" Name="__init__.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\__init__.py" />
                            </Component>
                            <Component Id="gdal.py" Guid="*">
                                <File Id="gdal.py" Name="gdal.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\gdal.py" />
                            </Component>
                            <Component Id="gdal_array.py" Guid="*">
                                <File Id="gdal_array.py" Name="gdal_array.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\gdal_array.py" />
                            </Component>
                            <Component Id="gdalnumeric.py" Guid="*">
                                <File Id="gdalnumeric.py" Name="gdalnumeric.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\gdalnumeric.py" />
                            </Component>
                            <Component Id="gdalconst.py" Guid="*">
                                <File Id="gdalconst.py" Name="gdalconst.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\gdalconst.py" />
                            </Component>
                            <Component Id="ogr.py" Guid="*">
                                <File Id="ogr.py" Name="ogr.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\ogr.py" />
                            </Component>
                            <Component Id="osr.py" Guid="*">
                                <File Id="osr.py" Name="osr.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\osr.py" />
                            </Component>
                            <Component Id="_gdal.pyd" Guid="*">
                                <File Id="_gdal.pyd" Name="_gdal.pyd" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\_gdal.pyd" />
                            </Component>
                            <Component Id="_gdalconst.pyd" Guid="E8E2473F-ACFA-4F63-9E4E-78487F9084DC">
                                <File Id="_gdalconst.pyd" Name="_gdalconst.pyd" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\_gdalconst.pyd" />
                            </Component>
                            <Component Id="_ogr.pyd" Guid="*">
                                <File Id="_ogr.pyd" Name="_ogr.pyd" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\_ogr.pyd" />
                            </Component>
                            <Component Id="_osr.pyd" Guid="*">
                                <File Id="_osr.pyd" Name="_osr.pyd" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\osgeo\_osr.pyd" />
                            </Component>
                        </Directory>
                        <Directory Id="scriptsDir" Name="scripts">
                            <Component Id="epsg_tr.py" Guid="*">
                                <File Id="epsg_tr.py" Name="epsg_tr.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\epsg_tr.py" />
                            </Component>
                            <Component Id="esri2wkt.py" Guid="*">
                                <File Id="esri2wkt.py" Name="esri2wkt.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\epsg_tr.py" />
                            </Component>
                            <Component Id="gcps2vec.py" Guid="*">
                                <File Id="gcps2vec.py" Name="gcps2vec.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gcps2vec.py" />
                            </Component>
                            <Component Id="gcps2wld.py" Guid="*">
                                <File Id="gcps2wld.py" Name="gcps2wld.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gcps2wld.py" />
                            </Component>
                            <Component Id="gdal_calc.py" Guid="*">
                                <File Id="gdal_calc.py" Name="gdal_calc.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdal_calc.py" />
                            </Component>
                            <Component Id="gdal_fillnodata.py" Guid="*">
                                <File Id="gdal_fillnodata.py" Name="gdal_fillnodata.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdal_fillnodata.py" />
                            </Component>
                            <Component Id="gdal_merge.py" Guid="*">
                                <File Id="gdal_merge.py" Name="gdal_merge.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdal_merge.py" />
                            </Component>
                            <Component Id="gdal_polygonize.py" Guid="*">
                                <File Id="gdal_polygonize.py" Name="gdal_polygonize.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdal_polygonize.py" />
                            </Component>
                            <Component Id="gdal_proximity.py" Guid="*">
                                <File Id="gdal_proximity.py" Name="gdal_proximity.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdal_proximity.py" />
                            </Component>
                            <Component Id="gdal_retile.py" Guid="*">
                                <File Id="gdal_retile.py" Name="gdal_retile.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdal_retile.py" />
                            </Component>
                            <Component Id="gdal_sieve.py" Guid="*">
                                <File Id="gdal_sieve.py" Name="gdal_sieve.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdal_sieve.py" />
                            </Component>
                            <Component Id="gdal2tiles.py" Guid="*">
                                <File Id="gdal2tiles.py" Name="gdal2tiles.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdal2tiles.py" />
                            </Component>
                            <Component Id="gdal2xyz.py" Guid="*">
                                <File Id="gdal2xyz.py" Name="gdal2xyz.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdal2xyz.py" />
                            </Component>
                            <Component Id="gdalchksum.py" Guid="*">
                                <File Id="gdalchksum.py" Name="gdalchksum.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdalchksum.py" />
                            </Component>
                            <Component Id="gdalident.py" Guid="*">
                                <File Id="gdalident.py" Name="gdalident.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdalident.py" />
                            </Component>
                            <Component Id="gdalimport.py" Guid="*">
                                <File Id="gdalimport.py" Name="gdalimport.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\gdalimport.py" />
                            </Component>
                            <Component Id="mkgraticule.py" Guid="*">
                                <File Id="mkgraticule.py" Name="mkgraticule.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\mkgraticule.py" />
                            </Component>
                            <Component Id="pct2rgb.py" Guid="*">
                                <File Id="pct2rgb.py" Name="pct2rgb.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\pct2rgb.py" />
                            </Component>
                            <Component Id="rgb2pct.py" Guid="*">
                                <File Id="rgb2pct.py" Name="rgb2pct.py" Source="$(var.SolutionDir)..\release-1900\bin\gdal\python\scripts\rgb2pct.py" />
                            </Component>
                        </Directory>                        
                    </Directory>
					          <Component Id="MapManager.exe" Guid="*">
                        <File Id="MapManager.exe" Name="$(var.MapManager.TargetFileName)" Source="$(var.MapManager.TargetPath)" />
                        <!-- Extend to the "open with" list + Win7 jump menu pinning  -->
                        <RegistryValue Root="HKCR" Key="Applications\MapManager.exe\SupportedTypes" Name=".map" Value="" Type="string" />
                        <RegistryValue Root="HKCR" Key="Applications\MapManager.exe\shell\open" Name="FriendlyAppName" Value="MapManager" Type="string" />
                        <RegistryValue Root="HKCR" Key="Applications\MapManager.exe\shell\open" Name="command" Value="&quot;[INSTALLDIR]MapManager.exe&quot; &quot;%1&quot;" Type="string" />

                        <!-- MapManager.Document ProgID -->
                        <RegistryValue Root="HKCR" Key="MapManager.Document" Name="FriendlyTypeName" Value="MapManager map file" Type="string" />
                        <RegistryValue Root="HKCR" Key=".map\OpenWithList\MapManager.exe" Value="" Type="string" />
                        <RegistryValue Root="HKCR" Key=".map\OpenWithProgids" Name="MapManager.Document" Value="" Type="string" />
                        <ProgId Id="MapManager.Document" Description="MapManager map file" Icon="MapManager.exe" IconIndex="0">
                            <Extension Id="map">
                                <Verb Id="open" Command="open" Argument="&quot;%1&quot;" TargetFile="MapManager.exe" />
                            </Extension>
                        </ProgId>

                        <!-- Optional: add an 'Edit with MapManager' to 'right click' even when not associated -->
                        <RegistryValue Root="HKCR" Key="SystemFileAssociations\.map\shell\edit.MapManager.exe" Value="Edit with MapManager" Type="string" />
                        <RegistryValue Root="HKCR" Key="SystemFileAssociations\.map\shell\edit.MapManager.exe\command" Value="&quot;[INSTALLDIR]MapManager.exe&quot; &quot;%1&quot;" Type="string" />
                    </Component>
                    <Component Id="MapManager.chm" Guid="*">
                        <File Id="MapManager.chm" Name="MapManager.chm" Source="$(var.SolutionDir)\help\MapManager.chm" Vital="yes"/>
                    </Component>
                    <Component Id="MapLibrary.dll" Guid="*">
                        <File Id="MapLibrary.dll" Name="MapLibrary.dll" Source="$(var.MapManager.TargetDir)MapLibrary.dll" Vital="yes"/>
                    </Component>
                    <Component Id="ScintillaNet.dll" Guid="*">
                        <File Id="ScintillaNet.dll" Name="ScintillaNet.dll" Source="$(var.MapManager.TargetDir)ScintillaNet.dll" Vital="yes"/>
                    </Component>
                    <Component Id="SciLexer.dll" Guid="*">
                        <File Id="SciLexer.dll" Name="SciLexer.dll" Source="$(var.MapManager.TargetDir)SciLexer.dll" Vital="yes"/>
                    </Component>
                    <Component Id="gdal.dll" Guid="*">
                        <File Id="gdal.dll" Name="gdal301.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal301.dll" Vital="yes"/>
                    </Component>
                    <Component Id="Microsoft.VisualBasic.PowerPacks.Vs.dll" Guid="*">
                        <File Id="Microsoft.VisualBasic.PowerPacks.Vs.dll" Name="Microsoft.VisualBasic.PowerPacks.Vs.dll" Source="$(var.MapManager.TargetDir)Microsoft.VisualBasic.PowerPacks.Vs.dll" Vital="yes"/>
                    </Component>
                    <Component Id="cairo.dll" Guid="*">
                        <File Id="cairo.dll" Name="cairo.dll" Source="$(var.SolutionDir)..\release-1900\bin\cairo.dll" Vital="yes"/>
                    </Component>
                    <Component Id="geos_c.dll" Guid="*">
                        <File Id="geos_c.dll" Name="geos_c.dll" Source="$(var.SolutionDir)..\release-1900\bin\geos_c.dll" Vital="yes"/>
                    </Component>
                    <Component Id="geos.dll" Guid="*">
                        <File Id="geos.dll" Name="geos.dll" Source="$(var.SolutionDir)..\release-1900\bin\geos.dll" Vital="yes"/>
                    </Component>
                    <Component Id="hdf5.dll" Guid="*">
                        <File Id="hdf5.dll" Name="hdf5.dll" Source="$(var.SolutionDir)..\release-1900\bin\hdf5.dll" Vital="yes"/>
                    </Component>
          <Component Id="hdf5_hl.dll" Guid="*">
                        <File Id="hdf5_hl.dll" Name="hdf5_hl.dll" Source="$(var.SolutionDir)..\release-1900\bin\hdf5_hl.dll" Vital="yes"/>
                    </Component>
                    <Component Id="hdfdll.dll" Guid="*">
                        <File Id="hdfdll.dll" Name="hdfdll.dll" Source="$(var.SolutionDir)..\release-1900\bin\hdfdll.dll" Vital="yes"/>
                    </Component>
                    <Component Id="mfhdfdll.dll" Guid="*">
                        <File Id="mfhdfdll.dll" Name="mfhdfdll.dll" Source="$(var.SolutionDir)..\release-1900\bin\mfhdfdll.dll" Vital="yes"/>
                    </Component>
                    <Component Id="xdrdll.dll" Guid="*">
                        <File Id="xdrdll.dll" Name="xdrdll.dll" Source="$(var.SolutionDir)..\release-1900\bin\xdrdll.dll" Vital="yes"/>
                    </Component>
                    <Component Id="szip.dll" Guid="*">
                        <File Id="szip.dll" Name="szip.dll" Source="$(var.SolutionDir)..\release-1900\bin\szip.dll" Vital="yes"/>
                    </Component>
                    <Component Id="iconv.dll" Guid="*">
                        <File Id="iconv.dll" Name="iconv.dll" Source="$(var.SolutionDir)..\release-1900\bin\iconv.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libcurl.dll" Guid="*">
                        <File Id="libcurl.dll" Name="libcurl.dll" Source="$(var.SolutionDir)..\release-1900\bin\libcurl.dll" Vital="yes"/>
                    </Component>
                    <Component Id="curl_ca_bundle.crt" Guid="*">
                        <File Id="curl_ca_bundle.crt" Name="curl-ca-bundle.crt" Source="$(var.SolutionDir)..\release-1900\bin\curl\curl-ca-bundle.crt" Vital="yes"/>
                    </Component>
                    <Component Id="MapfileConfig.xml" Guid="*">
                        <File Id="MapfileConfig.xml" Name="MapfileConfig.xml" Source="$(var.MapManager.TargetDir)MapfileConfig.xml" Vital="yes"/>
                    </Component>
                    <Component Id="libcrypto.dll" Guid="*">
                      <?if $(sys.BUILDARCH) = x64?>
                      <File Id="libcrypto.dll" Name="libcrypto-1_1-x64.dll" Source="$(var.SolutionDir)..\release-1900\bin\libcrypto-1_1-x64.dll" Vital="yes"/>
                      <?else?>
                      <File Id="libcrypto.dll" Name="libcrypto-1_1.dll" Source="$(var.SolutionDir)..\release-1900\bin\libcrypto-1_1.dll" Vital="yes"/>
                      <?endif?>
                    </Component>
                    <Component Id="libssl.dll" Guid="*">
                      <?if $(sys.BUILDARCH) = x64?>
                      <File Id="libssl.dll" Name="libssl-1_1-x64.dll" Source="$(var.SolutionDir)..\release-1900\bin\libssl-1_1-x64.dll" Vital="yes"/>
                      <?else?>
                      <File Id="libssl.dll" Name="libssl-1_1.dll" Source="$(var.SolutionDir)..\release-1900\bin\libssl-1_1.dll" Vital="yes"/>
                      <?endif?>
                    </Component>
                    <Component Id="TileGenerator.exe" Guid="*">
                        <File Id="TileGenerator.exe" Name="TileGenerator.exe" Source="$(var.MapManager.TargetDir)TileGenerator.exe" Vital="yes"/>
                    </Component>
                    <Component Id="expat.dll" Guid="*">
                        <File Id="expat.dll" Name="expat.dll" Source="$(var.SolutionDir)..\release-1900\bin\expat.dll" Vital="yes"/>
                    </Component>
                    <Component Id="fribidi.dll" Guid="*">
                        <File Id="fribidi.dll" Name="fribidi.dll" Source="$(var.SolutionDir)..\release-1900\bin\fribidi.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libfcgi.dll" Guid="*">
                        <File Id="libfcgi.dll" Name="libfcgi.dll" Source="$(var.SolutionDir)..\release-1900\bin\libfcgi.dll" Vital="yes"/>
                    </Component>
                    <Component Id="mapserver.dll" Guid="*">
                        <File Id="mapserver.dll" Name="mapserver.dll" Source="$(var.SolutionDir)..\release-1900\bin\mapserver.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libpq.dll" Guid="*">
                        <File Id="libpq.dll" Name="libpq.dll" Source="$(var.SolutionDir)..\release-1900\bin\libpq.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libmysql.dll" Guid="*">
                        <File Id="libmysql.dll" Name="libmysql.dll" Source="$(var.SolutionDir)..\release-1900\bin\libmysql.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libxml2.dll" Guid="*">
                        <File Id="libxml2.dll" Name="libxml2.dll" Source="$(var.SolutionDir)..\release-1900\bin\libxml2.dll" Vital="yes"/>
                    </Component>
                    <Component Id="mapscript.dll" Guid="*">
                        <File Id="mapscript.dll" Name="mapscript.dll" Source="$(var.SolutionDir)..\release-1900\bin\ms\csharp\mapscript.dll" Vital="yes"/>
                    </Component>
                    <Component Id="csharpmapscript.dll" Guid="*">
                      <File Id="csharpmapscript.dll" Name="csharpmapscript.dll" Source="$(var.SolutionDir)..\release-1900\bin\ms\csharp\mapscript.dll" Vital="yes"/>
                    </Component>
                    <Component Id="mapscript_csharp.dll" Guid="*">
                        <File Id="mapscript_csharp.dll" Name="mapscript_csharp.dll" Source="$(var.SolutionDir)..\release-1900\bin\ms\csharp\mapscript_csharp.dll" Vital="yes"/>
                    </Component>
                    <Component Id="netcdf.dll" Guid="*">
                        <File Id="netcdf.dll" Name="netcdf.dll" Source="$(var.SolutionDir)..\release-1900\bin\netcdf.dll" Vital="yes"/>
                    </Component>
                    <Component Id="openjp2.dll" Guid="*">
                        <File Id="openjp2.dll" Name="openjp2.dll" Source="$(var.SolutionDir)..\release-1900\bin\openjp2.dll" Vital="yes"/>
                    </Component>
                    <Component Id="ogr_csharp.dll" Guid="*">
                        <File Id="ogr_csharp.dll" Name="ogr_csharp.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\csharp\ogr_csharp.dll" Vital="yes"/>
                    </Component>
                    <Component Id="ogr_wrap.dll" Guid="*">
                        <File Id="ogr_wrap.dll" Name="ogr_wrap.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\csharp\ogr_wrap.dll" Vital="yes"/>
                    </Component>
                    <Component Id="osr_csharp.dll" Guid="*">
                        <File Id="osr_csharp.dll" Name="osr_csharp.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\csharp\osr_csharp.dll" Vital="yes"/>
                    </Component>
                    <Component Id="osr_wrap.dll" Guid="*">
                        <File Id="osr_wrap.dll" Name="osr_wrap.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\csharp\osr_wrap.dll" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_csharp.dll" Guid="*">
                        <File Id="gdal_csharp.dll" Name="gdal_csharp.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\csharp\gdal_csharp.dll" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_wrap.dll" Guid="*">
                        <File Id="gdal_wrap.dll" Name="gdal_wrap.dll" Source="$(var.SolutionDir)..\release-1900\bin\gdal\csharp\gdal_wrap.dll" Vital="yes"/>
                    </Component>
                    <Component Id="proj.dll" Guid="*">
                        <File Id="proj.dll" Name="proj.dll" Source="$(var.SolutionDir)..\release-1900\bin\proj.dll" Vital="yes"/>
                    </Component>
                    <Component Id="proj_6_1.dll" Guid="*">
                        <File Id="proj_6_1.dll" Name="proj_6_1.dll" Source="$(var.SolutionDir)..\release-1900\bin\proj_6_1.dll" Vital="yes"/>
                    </Component>
                    <Component Id="sqlite3.dll" Guid="*">
                        <File Id="sqlite3.dll" Name="sqlite3.dll" Source="$(var.SolutionDir)..\release-1900\bin\sqlite3.dll" Vital="yes"/>
                    </Component>
					<Component Id="freexl.dll" Guid="*">
                        <File Id="freexl.dll" Name="freexl.dll" Source="$(var.SolutionDir)..\release-1900\bin\freexl.dll" Vital="yes"/>
                    </Component>
                    <Component Id="spatialite.dll" Guid="*">
                        <File Id="spatialite.dll" Name="spatialite.dll" Source="$(var.SolutionDir)..\release-1900\bin\spatialite.dll" Vital="yes"/>
                    </Component>
                    <Component Id="xerces_c_3_2.dll" Guid="*">
                        <File Id="xerces_c_3_2.dll" Name="xerces-c_3_2.dll" Source="$(var.SolutionDir)..\release-1900\bin\xerces-c_3_2.dll" Vital="yes"/>
                    </Component>
                    <Component Id="zlib1.dll" Guid="*">
                        <File Id="zlib1.dll" Name="zlib1.dll" Source="$(var.SolutionDir)..\release-1900\bin\zlib1.dll" Vital="yes"/>
                    </Component>
                    <Component Id="cfitsio.dll" Guid="*">
                        <File Id="cfitsio.dll" Name="cfitsio.dll" Source="$(var.SolutionDir)..\release-1900\bin\cfitsio.dll" Vital="yes"/>
                    </Component>
                    <Component Id="msplugin_mssql2008.dll" Guid="*">
                        <File Id="msplugin_mssql2008.dll" Name="msplugin_mssql2008.dll" Source="$(var.SolutionDir)..\release-1900\bin\ms\plugins\mssql2008\msplugin_mssql2008.dll" />
                    </Component>
                    <Component Id="msplugin_oracle.dll" Guid="*">
                        <File Id="msplugin_oracle.dll" Name="msplugin_oracle.dll" Source="$(var.SolutionDir)..\release-1900\bin\ms\plugins\oci\msplugin_oracle.dll" />
                    </Component>
                    <Component Id="legend.exe" Guid="*">
                        <File Id="legend.exe" Name="legend.exe" Source="$(var.SolutionDir)..\release-1900\bin\ms\apps\legend.exe" />
                    </Component>
                    <Component Id="mapserv.exe" Guid="*">
                        <File Id="mapserv.exe" Name="mapserv.exe" Source="$(var.SolutionDir)..\release-1900\bin\ms\apps\mapserv.exe" />
                    </Component>
                    <Component Id="msencrypt.exe" Guid="*">
                        <File Id="msencrypt.exe" Name="msencrypt.exe" Source="$(var.SolutionDir)..\release-1900\bin\ms\apps\msencrypt.exe" />
                    </Component>
                    <Component Id="scalebar.exe" Guid="*">
                        <File Id="scalebar.exe" Name="scalebar.exe" Source="$(var.SolutionDir)..\release-1900\bin\ms\apps\scalebar.exe" />
                    </Component>
                    <Component Id="shp2img.exe" Guid="*">
                        <File Id="shp2img.exe" Name="shp2img.exe" Source="$(var.SolutionDir)..\release-1900\bin\ms\apps\shp2img.exe" />
                    </Component>
                    <Component Id="shptree.exe" Guid="*">
                        <File Id="shptree.exe" Name="shptree.exe" Source="$(var.SolutionDir)..\release-1900\bin\ms\apps\shptree.exe" />
                    </Component>
                    <Component Id="shptreevis.exe" Guid="*">
                        <File Id="shptreevis.exe" Name="shptreevis.exe" Source="$(var.SolutionDir)..\release-1900\bin\ms\apps\shptreevis.exe" />
                    </Component>
                    <Component Id="sortshp.exe" Guid="*">
                        <File Id="sortshp.exe" Name="sortshp.exe" Source="$(var.SolutionDir)..\release-1900\bin\ms\apps\sortshp.exe" />
                    </Component>
                    <Component Id="tile4ms.exe" Guid="*">
                        <File Id="tile4ms.exe" Name="tile4ms.exe" Source="$(var.SolutionDir)..\release-1900\bin\ms\apps\tile4ms.exe" />
                    </Component>
                    <Component Id="gdal_contour.exe" Guid="*">
                        <File Id="gdal_contour.exe" Name="gdal_contour.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdal_contour.exe" />
                    </Component>
                    <Component Id="gdal_grid.exe" Guid="*">
                        <File Id="gdal_grid.exe" Name="gdal_grid.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdal_grid.exe" />
                    </Component>
                    <Component Id="gdal_rasterize.exe" Guid="*">
                        <File Id="gdal_rasterize.exe" Name="gdal_rasterize.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdal_rasterize.exe" />
                    </Component>
                    <Component Id="gdal_translate.exe" Guid="*">
                        <File Id="gdal_translate.exe" Name="gdal_translate.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdal_translate.exe" />
                    </Component>
                    <Component Id="gdaladdo.exe" Guid="*">
                        <File Id="gdaladdo.exe" Name="gdaladdo.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdaladdo.exe" />
                    </Component>
                    <Component Id="gdalbuildvrt.exe" Guid="*">
                        <File Id="gdalbuildvrt.exe" Name="gdalbuildvrt.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdalbuildvrt.exe" />
                    </Component>
                    <Component Id="gdaldem.exe" Guid="*">
                        <File Id="gdaldem.exe" Name="gdaldem.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdaldem.exe" />
                    </Component>
                    <Component Id="gdalenhance.exe" Guid="*">
                        <File Id="gdalenhance.exe" Name="gdalenhance.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdalenhance.exe" />
                    </Component>
                    <Component Id="gdalinfo.exe" Guid="*">
                        <File Id="gdalinfo.exe" Name="gdalinfo.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdalinfo.exe" />
                    </Component>
                    <Component Id="gdallocationinfo.exe" Guid="*">
                        <File Id="gdallocationinfo.exe" Name="gdallocationinfo.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdallocationinfo.exe" />
                    </Component>
                    <Component Id="gdalmanage.exe" Guid="*">
                        <File Id="gdalmanage.exe" Name="gdalmanage.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdalmanage.exe" />
                    </Component>
                    <Component Id="gdalsrsinfo.exe" Guid="*">
                        <File Id="gdalsrsinfo.exe" Name="gdalsrsinfo.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdalsrsinfo.exe" />
                    </Component>
                    <Component Id="gdaltindex.exe" Guid="*">
                        <File Id="gdaltindex.exe" Name="gdaltindex.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdaltindex.exe" />
                    </Component>
                    <Component Id="gdaltransform.exe" Guid="*">
                        <File Id="gdaltransform.exe" Name="gdaltransform.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdaltransform.exe" />
                    </Component>
                    <Component Id="gdalwarp.exe" Guid="*">
                        <File Id="gdalwarp.exe" Name="gdalwarp.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gdalwarp.exe" />
                    </Component>
                    <Component Id="gnmanalyse.exe" Guid="*">
                        <File Id="gnmanalyse.exe" Name="gnmanalyse.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gnmanalyse.exe" />
                    </Component>
                    <Component Id="gnmmanage.exe" Guid="*">
                        <File Id="gnmmanage.exe" Name="gnmmanage.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\gnmmanage.exe" />
                    </Component>
                    <Component Id="nearblack.exe" Guid="*">
                        <File Id="nearblack.exe" Name="nearblack.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\nearblack.exe" />
                    </Component>
                    <Component Id="ogr2ogr.exe" Guid="*">
                        <File Id="ogr2ogr.exe" Name="ogr2ogr.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\ogr2ogr.exe" />
                    </Component>
                    <Component Id="ogrinfo.exe" Guid="*">
                        <File Id="ogrinfo.exe" Name="ogrinfo.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\ogrinfo.exe" />
                    </Component>
                    <Component Id="ogrlineref.exe" Guid="*">
                        <File Id="ogrlineref.exe" Name="ogrlineref.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\ogrlineref.exe" />
                    </Component>
                    <Component Id="ogrtindex.exe" Guid="*">
                        <File Id="ogrtindex.exe" Name="ogrtindex.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\ogrtindex.exe" />
                    </Component>
                    <Component Id="testepsg.exe" Guid="*">
                        <File Id="testepsg.exe" Name="testepsg.exe" Source="$(var.SolutionDir)..\release-1900\bin\gdal\apps\testepsg.exe" />
                    </Component>
                    <Component Id="mmshell.bat" Guid="*">
                        <File Id="mmshell.bat" Name="mmshell.bat" Source="$(var.SolutionDir)\Installer\mmshell.bat" />
                    </Component>
                    <Component Id="vcruntime140.dll" Guid="*">
                        <File Id="vcruntime140.dll" Name="vcruntime140.dll" Source="$(var.SolutionDir)..\release-1900\bin\vcruntime140.dll" />
                    </Component>
                    <Component Id="msvcp140.dll" Guid="*">
                        <File Id="msvcp140.dll" Name="msvcp140.dll" Source="$(var.SolutionDir)..\release-1900\bin\msvcp140.dll" />
                    </Component>
                </Directory>
            </Directory>
          
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ProgramMenuDir" Name="MapServer MapManager" >
                    <Component Id="ApplicationShortcut" Guid="*">
                        <Shortcut Id="startmenuMapManager" Target="[INSTALLDIR]MapManager.exe" WorkingDirectory="INSTALLDIR" Name="MapServer MapManager" Icon="MapManager.ico" />
                        <Shortcut Id="desktopshortcutMapManager" Target="[INSTALLDIR]MapManager.exe" WorkingDirectory="INSTALLDIR" Name="MapServer MapManager" Icon="MapManager.ico" Directory="DesktopFolder" />
                        <Shortcut Id="commandpromptMapManager" Target="[SystemFolder]cmd.exe" Arguments="/k &quot;[INSTALLDIR]mmshell.bat&quot;" WorkingDirectory="INSTALLDIR" Name="MapManager Command Prompt" />
                        <Shortcut Id="helpMapManager" Target="[INSTALLDIR]MapManager.chm" WorkingDirectory="INSTALLDIR" Name="MapServer MapManager User Manual" />
                        <Shortcut Id="licenseMapManager" Target="[licenseDir]" WorkingDirectory="INSTALLDIR" Name="License" />
                        <Shortcut Id="UninstallProduct" Name="Uninstall MapServer MapManager" Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" Description="Uninstalls MapServer MapManager" />
                        <RemoveFolder Id="ProgramMenuDir" On="uninstall"/>
                        <RegistryValue Root="HKCU" Key="Software\DMS\MapManager" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
                    </Component>
                </Directory>
            </Directory>

            <Directory Id="AppDataFolder" Name="AppDataFolder">  
                <Directory Id="DMSAppFolder" Name="MapManager">
                    <Component Id="DMSAppFolder" Guid="*">
                        <CreateFolder Directory="DMSAppFolder"/>
                        <RemoveFile Id="PurgeAppFolder" Name="*.*" On="uninstall" />
                        <RemoveFolder Id="DMSAppFolder" On="uninstall"/>
                        <RegistryValue Root="HKCU" Key="Software\DMS\MapManager" Name="installed2" Type="integer" Value="1" KeyPath="yes"/>
                    </Component>
                </Directory>
            </Directory>

            <Directory Id="FontsFolder">
                <Component Id="MapServerAnimals.ttf" Guid="*">
                    <File Id="MapServerAnimals.ttf" Source="$(var.SolutionDir)Templates\fonts\MapServerAnimals.ttf" TrueType="yes" />
                </Component>
                <Component Id="MapServerCarto.ttf" Guid="*">
                    <File Id="MapServerCarto.ttf" Source="$(var.SolutionDir)Templates\fonts\MapServerCarto.ttf" TrueType="yes" />
                </Component>
                <Component Id="MapServerNaturalResources.ttf" Guid="*">
                    <File Id="MapServerNaturalResources.ttf" Source="$(var.SolutionDir)Templates\fonts\MapServerNaturalResources.ttf" TrueType="yes" />
                </Component>
                <Component Id="MapServerParks.ttf" Guid="*">
                    <File Id="MapServerParks.ttf" Source="$(var.SolutionDir)Templates\fonts\MapServerParks.ttf" TrueType="yes" />
                </Component>
                <Component Id="MapServerRecreation.ttf" Guid="*">
                    <File Id="MapServerRecreation.ttf" Source="$(var.SolutionDir)Templates\fonts\MapServerRecreation.ttf" TrueType="yes" />
                </Component>
                <Component Id="MapServerSigns.ttf" Guid="*">
                    <File Id="MapServerSigns.ttf" Source="$(var.SolutionDir)Templates\fonts\MapServerSigns.ttf" TrueType="yes" />
                </Component>
                <Component Id="MapServerSports.ttf" Guid="*">
                    <File Id="MapServerSports.ttf" Source="$(var.SolutionDir)Templates\fonts\MapServerSports.ttf" TrueType="yes" />
                </Component>
            </Directory>

        </Directory>

        <Icon Id="MapManager.ico" SourceFile="$(var.MapManager.ProjectDir)\Images\MapManager.ico"/>
        <Property Id="ARPPRODUCTICON" Value="MapManager.ico" />

        <UI>
            <UIRef Id="WixUI_Mondo" />
            <UIRef Id="WixUI_ErrorProgressText" />
            <Publish Dialog="ExitDialog" Control="Finish" Event="DoAction" Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
        </UI>
        <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch MapManager" />
        <Property Id="WixShellExecTarget" Value="[#MapManager.exe]" />
        <CustomAction Id="PostInstallExecute" FileKey="MapManager.exe" ExeCommand="/postinstall" Impersonate="no" Execute="deferred"/>
        <CustomAction Id="LaunchApplication" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" />

        <InstallExecuteSequence>
            <Custom Action="PostInstallExecute" Before="InstallFinalize">NOT Installed</Custom>
        </InstallExecuteSequence>


        <WixVariable Id="WixUILicenseRtf" Value="$(var.SolutionDir)MapManagerLicense.rtf" />
        <WixVariable Id="WixUIBannerBmp" Value="$(var.ProjectDir)\Images\bannrbmp.bmp" />
        <WixVariable Id="WixUIDialogBmp" Value="$(var.ProjectDir)\Images\dlgbmp.bmp" />

        <Feature Id="Complete" Title="MapManager Application" Display="expand" Level="1" Description="The MapManager application" ConfigurableDirectory="INSTALLDIR">
            <Feature Id="MainProgram" Level="1" Title="Core Components" Absent="disallow" Description="The core components of the application">
                <ComponentRef Id="DMSAppFolder" />
                <ComponentRef Id="MapManager.exe" />
                <ComponentRef Id="MapManager.chm" />
                <ComponentRef Id="MapLibrary.dll" />
                <ComponentRef Id="GDALLicense.rtf" />
                <ComponentRef Id="MapManagerLicense.rtf" />
                <ComponentRef Id="ScintillaNet.dll" />
                <ComponentRef Id="SciLexer.dll" />
                <ComponentRef Id="cairo.dll" />
                <ComponentRef Id="gdal.dll" />
                <ComponentRef Id="geos_c.dll" />
                <ComponentRef Id="geos.dll" />
                <ComponentRef Id="iconv.dll" />
                <ComponentRef Id="libcurl.dll" />
                <ComponentRef Id="curl_ca_bundle.crt" />
                <ComponentRef Id="MapfileConfig.xml" />
                <ComponentRef Id="libssl.dll" />
                <ComponentRef Id="libcrypto.dll" />
                <ComponentRef Id="expat.dll" />
                <ComponentRef Id="libfcgi.dll" />
                <ComponentRef Id="mapserver.dll" />
                <ComponentRef Id="libpq.dll" />
                <ComponentRef Id="libmysql.dll" />
                <ComponentRef Id="libxml2.dll" />
                <ComponentRef Id="mapscript.dll" />
                <ComponentRef Id="csharpmapscript.dll" />
                <ComponentRef Id="mapscript_csharp.dll" />
                <ComponentRef Id="ogr_csharp.dll" />
                <ComponentRef Id="ogr_wrap.dll" />
                <ComponentRef Id="osr_csharp.dll" />
                <ComponentRef Id="osr_wrap.dll" />
                <ComponentRef Id="gdal_csharp.dll" />
                <ComponentRef Id="gdal_wrap.dll" />
                <ComponentRef Id="openjp2.dll" />
                <ComponentRef Id="proj.dll" />
                <ComponentRef Id="proj_6_1.dll" />
                <ComponentRef Id="fribidi.dll" />
                <ComponentRef Id="sqlite3.dll" />
			          <ComponentRef Id="freexl.dll" />
                <ComponentRef Id="spatialite.dll" />
                <ComponentRef Id="xerces_c_3_2.dll" />
                <ComponentRef Id="zlib1.dll" />
                <ComponentRef Id="ApplicationShortcut" />
                <ComponentRef Id="epsg" />
                <ComponentRef Id="world" />
                <ComponentRef Id="WO" />
                <ComponentRef Id="WI" />
                <ComponentRef Id="TN" />
                <ComponentRef Id="stpaul" />
                <ComponentRef Id="stlrnc" />
                <ComponentRef Id="stgeorge" />
                <ComponentRef Id="prvi" />
                <ComponentRef Id="proj.db" />
                <ComponentRef Id="proj_def.dat" />                
                <ComponentRef Id="other.extra" />
                <ComponentRef Id="nzgd2kgrid0005.gsb" />
                <ComponentRef Id="null" />
                <ComponentRef Id="ntv1_can.dat" />
                <ComponentRef Id="ntf_r93.gsb" />
                <ComponentRef Id="nad83" />
                <ComponentRef Id="nad27" />
                <ComponentRef Id="nad.lst" />
                <ComponentRef Id="MD" />
                <ComponentRef Id="IGNF" />
                <ComponentRef Id="ITRF2014" />
                <ComponentRef Id="ITRF2008" />
                <ComponentRef Id="ITRF2000" />
                <ComponentRef Id="hawaii" />
                <ComponentRef Id="GL27" />
                <ComponentRef Id="esri.extra" />
                <ComponentRef Id="esri" />
                <ComponentRef Id="egm96_15.gtx" />
                <ComponentRef Id="conus" />
                <ComponentRef Id="CH" />
                <ComponentRef Id="BETA2007.gsb" />
                <ComponentRef Id="alaska" />
                <ComponentRef Id="new.map" />
                <ComponentRef Id="mmstyles.map" />
                <ComponentRef Id="annotation.map" />
                <ComponentRef Id="symbols.sym" />
                <ComponentRef Id="font.list" />
                <ComponentRef Id="flaeche1.png" />
                <ComponentRef Id="flaeche1_1.png" />
                <ComponentRef Id="flaeche2.png" />
                <ComponentRef Id="flaeche2_1.png" />
                <ComponentRef Id="flaeche3.png" />
                <ComponentRef Id="schraffur.png" />
                <ComponentRef Id="stern.png" />
                <ComponentRef Id="welle.png" />
                <ComponentRef Id="MapServerAnimals.ttf" />
                <ComponentRef Id="MapServerCarto.ttf" />
                <ComponentRef Id="MapServerNaturalResources.ttf" />
                <ComponentRef Id="MapServerParks.ttf" />
                <ComponentRef Id="MapServerRecreation.ttf" />
                <ComponentRef Id="MapServerSigns.ttf" />
                <ComponentRef Id="MapServerSports.ttf" />
                <ComponentRef Id="Microsoft.VisualBasic.PowerPacks.Vs.dll" />
                <ComponentRef Id="TileGenerator.exe" />
                <ComponentGroupRef Id="GdalData" />
            </Feature>
            <Feature Id="MSPlugins" Level="1" Title="Mapserver Plugins" Display="expand" Description="Mapserver plugin library files">
                <Feature Id="ms_sql2008" Level="1" Title="MSSQL 2008" Description="MSSQL 2008 plugin library">
                    <ComponentRef Id="msplugin_mssql2008.dll" />
                </Feature>
                <Feature Id="ms_oracle" Level="1000" Title="ORACLE" Description="ORACLE OCI plugin library">
                    <ComponentRef Id="msplugin_oracle.dll" />
                </Feature>
            </Feature>
            <Feature Id="GDALPlugins" Level="1" Title="GDAL Plugins" Display="expand" Description="GDAL plugin library files">
                <Feature Id="NetCDF" Level="1" Title="NetCDF" Description="Network Common Data Form (NetCDF) rasters (for the custom licensing terms please review NetCDFLicense.rtf and SZIPLicense.rtf installed in the /license folder)">
                  <ComponentRef Id="gdal_netCDF.dll" />
                  <ComponentRef Id="gdal_GMT.dll" />
                  <ComponentRef Id="netcdf.dll" />
                  <ComponentRef Id="NetCDFLicense.rtf" />
                  <ComponentRef Id="hdf5.dll" />
                  <ComponentRef Id="hdf5_hl.dll" />
                  <ComponentRef Id="HDF5License.rtf" />
                  <ComponentRef Id="SZIPLicense.rtf" />
                  <ComponentRef Id="szip.dll" />
              </Feature>
              <Feature Id="HDF4" Level="1" Title="HDF4" Description="Hierarchical Data Format Release 4 (HDF4) rasters (for the custom licensing terms please review HDF4License.rtf and SZIPLicense.rtf installed in the /license folder)">
                  <ComponentRef Id="gdal_HDF4.dll" />
                  <ComponentRef Id="gdal_HDF4Image.dll" />
                  <ComponentRef Id="hdfdll.dll" />
                  <ComponentRef Id="mfhdfdll.dll" />
                  <ComponentRef Id="xdrdll.dll" />
                  <ComponentRef Id="HDF4License.rtf" />
                  <ComponentRef Id="SZIPLicense.rtf" />
                  <ComponentRef Id="szip.dll" />
              </Feature>
              <Feature Id="HDF5" Level="1" Title="HDF5" Description="Hierarchical Data Format Release 5 (HDF5) rasters (for the custom licensing terms please review HDF5License.rtf and SZIPLicense.rtf installed in the /license folder)">
                  <ComponentRef Id="gdal_HDF5.dll" />
                  <ComponentRef Id="gdal_BAG.dll" />
                  <ComponentRef Id="gdal_HDF5Image.dll" />
                  <ComponentRef Id="hdf5.dll" />
                  <ComponentRef Id="hdf5_hl.dll" />
                  <ComponentRef Id="HDF5License.rtf" />
                  <ComponentRef Id="SZIPLicense.rtf" />
                  <ComponentRef Id="szip.dll" />
              </Feature>
              <Feature Id="FITS" Level="1" Title="FITS" Description="Flexible Image Transport System (FITS) rasters (for the custom licensing terms please review FITSLicense.rtf installed in the /license folder)">
                  <ComponentRef Id="gdal_FITS.dll" />
                  <ComponentRef Id="cfitsio.dll" />
                  <ComponentRef Id="FITSLicense.rtf" />
              </Feature>
            </Feature>
        </Feature>
        <Feature Id="Tools" Title="Command Tools" Display="expand" Level="1" Description="Command Tools" ConfigurableDirectory="INSTALLDIR">
            <ComponentRef Id="mmshell.bat" />
            <Feature Id="MapServerTools" Level="1" Title="MapServer Tools" Description="MapServer Command Tools (legend, mapserv, msencrypt, scalebar, shp2img, shptree, shptreevis, sortshp, tile4ms)">

                <ComponentRef Id="legend.exe" />
                <ComponentRef Id="mapserv.exe" />
                <ComponentRef Id="msencrypt.exe" />
                <ComponentRef Id="scalebar.exe" />
                <ComponentRef Id="shp2img.exe" />
                <ComponentRef Id="shptree.exe" />
                <ComponentRef Id="shptreevis.exe" />
                <ComponentRef Id="sortshp.exe" />
                <ComponentRef Id="tile4ms.exe" />
            </Feature>
            <Feature Id="GDALTools" Level="1" Title="GDAL Tools" Description="GDAL Command Tools (gdal_contour, gdal_grid,gdal_rasterize, gdal_translate, gdaladdo, gdalbuildvrt, gdaldem, gdalenhance, gdalinfo, gdallocationinfo, gdalmanage, gdalsrsinfo, gdaltindex, gdaltransform, gdalwarp, nearblack, ogr2ogr, ogrinfo, ogrtindex, testepsg)">
                <ComponentRef Id="gdal_contour.exe" />
                <ComponentRef Id="gdal_grid.exe" />
                <ComponentRef Id="gdal_rasterize.exe" />
                <ComponentRef Id="gdal_translate.exe" />
                <ComponentRef Id="gdaladdo.exe" />
                <ComponentRef Id="gdalbuildvrt.exe" />
                <ComponentRef Id="gdaldem.exe" />
                <ComponentRef Id="gdalenhance.exe" />
                <ComponentRef Id="gdalinfo.exe" />
                <ComponentRef Id="gdallocationinfo.exe" />
                <ComponentRef Id="gdalmanage.exe" />
                <ComponentRef Id="gdalsrsinfo.exe" />
                <ComponentRef Id="gdaltindex.exe" />
                <ComponentRef Id="gdaltransform.exe" />
                <ComponentRef Id="gdalwarp.exe" />
                <ComponentRef Id="gnmanalyse.exe" />
                <ComponentRef Id="gnmmanage.exe" />
                <ComponentRef Id="nearblack.exe" />
                <ComponentRef Id="ogr2ogr.exe" />
                <ComponentRef Id="ogrinfo.exe" />
                <ComponentRef Id="ogrlineref.exe" />
                <ComponentRef Id="ogrtindex.exe" />
                <ComponentRef Id="testepsg.exe" />
                <ComponentRef Id="vcruntime140.dll" />
                <ComponentRef Id="msvcp140.dll" />
            </Feature>
            <Feature Id="Python27" Level="1" Title="Python Bindings" Description="GDAL and MapServer Python Files (requires Python 2.7)">
                <ComponentRef Id="mapscript.py" />
                <ComponentRef Id="_mapscript.pyd" />
                <ComponentRef Id="__init__.py" />
                <ComponentRef Id="_gdal.pyd" />
                <ComponentRef Id="_gdalconst.pyd" />
                <ComponentRef Id="_ogr.pyd" />
                <ComponentRef Id="_osr.pyd" />
                <ComponentRef Id="gdal.py" />
                <ComponentRef Id="gdal_array.py" />
                <ComponentRef Id="gdalconst.py" />
                <ComponentRef Id="gdalnumeric.py" />
                <ComponentRef Id="ogr.py" />
                <ComponentRef Id="osr.py" />
            </Feature>
            <Feature Id="PythonTools" Level="1" Title="Python Tools" Description="GDAL Python Tools">
                <ComponentRef Id="epsg_tr.py" />
                <ComponentRef Id="esri2wkt.py" />
                <ComponentRef Id="gcps2vec.py" />
                <ComponentRef Id="gcps2wld.py" />
                <ComponentRef Id="gdal_calc.py" />
                <ComponentRef Id="gdal_fillnodata.py" />
                <ComponentRef Id="gdal_merge.py" />
                <ComponentRef Id="gdal_polygonize.py" />
                <ComponentRef Id="gdal_proximity.py" />
                <ComponentRef Id="gdal_retile.py" />
                <ComponentRef Id="gdal_sieve.py" />
                <ComponentRef Id="gdal2tiles.py" />
                <ComponentRef Id="gdal2xyz.py" />
                <ComponentRef Id="gdalchksum.py" />
                <ComponentRef Id="gdalident.py" />
                <ComponentRef Id="gdalimport.py" />
                <ComponentRef Id="mkgraticule.py" />
                <ComponentRef Id="pct2rgb.py" />
                <ComponentRef Id="rgb2pct.py" />
            </Feature>
        </Feature>
	</Product>
</Wix>
